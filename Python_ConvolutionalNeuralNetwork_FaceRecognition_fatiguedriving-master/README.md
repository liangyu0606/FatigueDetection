# 🚗 智能疲劳驾驶检测系统

基于Python卷积神经网络的实时疲劳检测与预警系统，集成用户权限管理和系统日志功能。

## 🎯 系统特性

### 核心功能
- **实时疲劳检测**: 基于CNN和传统算法的混合检测方案
- **多级预警系统**: 智能分级预警，提供及时提醒
- **用户权限管理**: 支持管理员、驾驶员、监控员三种角色
- **系统日志记录**: 完整的操作日志和系统状态追踪
- **数据统计分析**: 疲劳事件统计和趋势分析
- **现代化界面**: 美观的用户界面设计

### 技术特点
- **混合检测算法**: CNN深度学习 + 传统图像处理
- **实时视频处理**: 优化的视频流处理和帧率控制
- **自适应光照**: 自动亮度调整和光照补偿
- **持续监测**: 智能状态跟踪和疲劳程度评估

## 🛠️ 技术栈

- **开发环境**: Python 3.6+ + PySide6 + OpenCV
- **深度学习**: TensorFlow/Keras + MobileNet/ResNet
- **图像处理**: OpenCV + dlib + imutils
- **数据库**: SQLite3
- **界面框架**: PySide6 (Qt6)

## 📁 项目结构

```
疲劳检测系统/
├── 核心模块/
│   ├── enhanced_main.py           # 主程序入口（推荐）
│   ├── main.py                    # 基础版主程序
│   └── main_ui.py                 # 现代化主界面
│
├── 检测模块/
│   └── simple_cnn_detector.py     # CNN疲劳检测器
│
├── 用户管理/
│   ├── user_management.py         # 用户权限管理
│   ├── user_interface.py          # 用户管理界面
│   ├── system_logger.py           # 系统日志记录
│   └── log_viewer.py              # 日志查看器
│
├── 数据处理/
│   ├── fatigue_statistics.py      # 统计数据管理
│   └── statistics_widget.py       # 统计界面组件
│
├── 配置文件/
│   ├── camera_config.py           # 摄像头配置
│   ├── camera_config.json         # 摄像头配置文件
│   └── requirements.txt           # 依赖包列表
│
├── 模型文件/
│   └── model/
│       ├── fatigue_model_mobilenet.h5      # 训练好的CNN模型
│       ├── class_indices.json              # 类别索引
│       └── shape_predictor_68_face_landmarks.dat  # 人脸关键点模型
│
├── 文档/
│   ├── README.md                   # 项目说明（本文件）
│   └── 使用指南.md                 # 中文使用指南
│
└── 数据库/
    └── fatigue_data.db            # SQLite数据库文件
```

## 🚀 快速开始

### 1. 环境准备

```bash
# 安装依赖
pip install -r requirements.txt

# 如果需要CNN功能，确保安装TensorFlow
pip install tensorflow>=2.8.0
```

### 2. 运行系统

#### 推荐：增强版本（含用户管理）
```bash
python enhanced_main.py
```

#### 基础版本（传统检测）
```bash
python main.py
```

### 3. 默认登录信息

- **管理员账户**
  - 用户名: `admin`
  - 密码: `admin123`
  - 权限: 完全访问权限

## 👥 用户角色权限

### 管理员 (Admin)
- ✅ 用户管理：创建、编辑、删除用户
- ✅ 系统配置：修改系统参数
- ✅ 日志管理：查看所有系统日志
- ✅ 检测功能：完整的检测控制权限
- ✅ 数据管理：访问所有数据和报告

### 监控员 (Monitor)
- ❌ 用户管理
- ✅ 系统配置：部分配置权限
- ✅ 日志管理：查看相关日志
- ✅ 检测功能：监控和控制检测
- ✅ 数据管理：查看和分析数据

### 驾驶员 (Driver)
- ❌ 用户管理
- ❌ 系统配置
- ❌ 日志管理
- ✅ 检测功能：启动、停止检测
- ✅ 数据查看：查看自己的数据

## 🔧 系统配置

### 检测参数
- **眨眼阈值**: 控制眨眼检测的敏感度
- **疲劳阈值**: 设置疲劳判定的标准
- **检测间隔**: 调整检测频率
- **预警级别**: 配置多级预警系统

### 摄像头设置
- **分辨率**: 支持多种分辨率设置
- **帧率**: 可调节的视频帧率
- **亮度调整**: 自动或手动亮度控制
- **对比度**: 图像对比度优化

## 📊 功能模块

### 疲劳检测算法
1. **传统算法**: 基于眼部纵横比(EAR)的疲劳检测
2. **CNN算法**: 深度学习模型进行疲劳状态分类
3. **混合算法**: 结合传统和深度学习的优势

### 数据统计
- 疲劳事件记录和统计
- 检测会话时长统计
- 疲劳趋势分析
- 导出统计报告

### 预警系统
- 声音预警
- 视觉提示
- 多级预警机制
- 自定义预警设置

## 🎯 使用场景

- **商用车辆**: 长途货运、客运车辆
- **私人车辆**: 个人驾驶安全监控
- **驾驶培训**: 驾校训练辅助工具
- **研究应用**: 疲劳检测算法研究

## 📈 性能指标

- **检测精度**: 混合算法达到90%+准确率
- **实时性**: 支持30FPS实时检测
- **稳定性**: 长时间运行稳定
- **兼容性**: 支持多种摄像头设备

## 🔍 故障排除

### 常见问题
1. **摄像头无法打开**: 检查设备连接和驱动
2. **检测精度低**: 调整光照条件和摄像头角度
3. **系统卡顿**: 降低检测频率或分辨率
4. **模型加载失败**: 确保TensorFlow正确安装

### 技术支持
- 查看项目文档获取详细信息
- 检查系统日志了解错误详情
- 使用内置的摄像头测试工具诊断问题

## 📝 更新日志

### v2.0.0 (最新版本)
- ✅ 添加用户权限管理系统
- ✅ 集成系统日志功能
- ✅ 现代化界面设计
- ✅ CNN疲劳检测集成
- ✅ 增强的数据统计功能
- ✅ 优化视频处理性能

### v1.0.0 (基础版本)
- ✅ 基础疲劳检测功能
- ✅ 传统图像处理算法
- ✅ 简单的用户界面
- ✅ 基本的预警功能

## 📄 许可证

本项目仅供学习和研究使用。

## 🤝 贡献

欢迎提交问题报告和功能建议！
